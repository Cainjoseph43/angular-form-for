angular.module("formFor",[]);var formFor;!function(e){var t=function(){function e(){this.restrict="A"}return e.prototype.link=function(e,t,r){e.$watch("model.uid",function(e){r.$set("ariaDescribedby",e+"-error"),r.$set("ariaLabelledby",e+"-label")}),e.$watch("model.error",function(e){r.$set("ariaInvalid",!!e)})},e}();e.AriaManager=t,angular.module("formFor").directive("ariaManager",function(){return new t})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(){this.autoGenerateLabels_=!1,this.defaultDebounceDuration_=500,this.defaultSubmitComplete_=angular.noop,this.defaultSubmitError_=angular.noop,this.defaultValidationFailed_=angular.noop,this.requiredLabel_=null,this.validationFailedForCustomMessage_="Failed custom validation",this.validationFailedForEmailTypeMessage_="Invalid email format",this.validationFailedForIntegerTypeMessage_="Must be an integer",this.validationFailedForMaxCollectionSizeMessage_="Must be fewer than {{num}} items",this.validationFailedForMaximumMessage_="Must be no more than {{num}}",this.validationFailedForMaxLengthMessage_="Must be fewer than {{num}} characters",this.validationFailedForMinimumMessage_="Must be at least {{num}}",this.validationFailedForMinCollectionSizeMessage_="Must at least {{num}} items",this.validationFailedForMinLengthMessage_="Must be at least {{num}} characters",this.validationFailedForNegativeTypeMessage_="Must be negative",this.validationFailedForNonNegativeTypeMessage_="Must be non-negative",this.validationFailedForNumericTypeMessage_="Must be numeric",this.validationFailedForPatternMessage_="Invalid format",this.validationFailedForPositiveTypeMessage_="Must be positive",this.validationFailedForRequiredMessage_="Required field"}return Object.defineProperty(t.prototype,"autoGenerateLabels",{get:function(){return this.autoGenerateLabels_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultDebounceDuration",{get:function(){return this.defaultDebounceDuration_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultSubmitComplete",{get:function(){return this.defaultSubmitComplete_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultSubmitError",{get:function(){return this.defaultSubmitError_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultValidationFailed",{get:function(){return this.defaultValidationFailed_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requiredLabel",{get:function(){return this.requiredLabel_},enumerable:!0,configurable:!0}),t.prototype.disableAutoLabels=function(){this.autoGenerateLabels_=!1},t.prototype.enableAutoLabels=function(){this.autoGenerateLabels_=!0},t.prototype.getFailedValidationMessage=function(t){switch(t){case e.ValidationFailureType.CUSTOM:return this.validationFailedForCustomMessage_;case e.ValidationFailureType.COLLECTION_MAX_SIZE:return this.validationFailedForMaxCollectionSizeMessage_;case e.ValidationFailureType.COLLECTION_MIN_SIZE:return this.validationFailedForMinCollectionSizeMessage_;case e.ValidationFailureType.MINIMUM:return this.validationFailedForMinimumMessage_;case e.ValidationFailureType.MAX_LENGTH:return this.validationFailedForMaxLengthMessage_;case e.ValidationFailureType.MAXIMUM:return this.validationFailedForMaximumMessage_;case e.ValidationFailureType.MIN_LENGTH:return this.validationFailedForMinLengthMessage_;case e.ValidationFailureType.PATTERN:return this.validationFailedForPatternMessage_;case e.ValidationFailureType.REQUIRED:return this.validationFailedForRequiredMessage_;case e.ValidationFailureType.TYPE_EMAIL:return this.validationFailedForEmailTypeMessage_;case e.ValidationFailureType.TYPE_INTEGER:return this.validationFailedForIntegerTypeMessage_;case e.ValidationFailureType.TYPE_NEGATIVE:return this.validationFailedForNegativeTypeMessage_;case e.ValidationFailureType.TYPE_NON_NEGATIVE:return this.validationFailedForNonNegativeTypeMessage_;case e.ValidationFailureType.TYPE_NUMERIC:return this.validationFailedForNumericTypeMessage_;case e.ValidationFailureType.TYPE_POSITIVE:return this.validationFailedForPositiveTypeMessage_}},t.prototype.setDefaultDebounceDuration=function(e){this.defaultDebounceDuration_=e},t.prototype.setDefaultSubmitComplete=function(e){this.defaultSubmitComplete_=e},t.prototype.setDefaultSubmitError=function(e){this.defaultSubmitError_=e},t.prototype.setDefaultValidationFailed=function(e){this.defaultValidationFailed_=e},t.prototype.setRequiredLabel=function(e){this.requiredLabel_=e},t.prototype.setValidationFailedForCustomMessage=function(e){this.validationFailedForCustomMessage_=e},t.prototype.setValidationFailedForMaxCollectionSizeMessage=function(e){this.validationFailedForMaxCollectionSizeMessage_=e},t.prototype.setValidationFailedForMaximumMessage=function(e){this.validationFailedForMaximumMessage_=e},t.prototype.setValidationFailedForMaxLengthMessage=function(e){this.validationFailedForMaxLengthMessage_=e},t.prototype.setValidationFailedForMinCollectionSizeMessage=function(e){this.validationFailedForMaxCollectionSizeMessage_=e},t.prototype.setValidationFailedForMinimumMessage=function(e){this.validationFailedForMinimumMessage_=e},t.prototype.setValidationFailedForMinLengthMessage=function(e){this.validationFailedForMinLengthMessage_=e},t.prototype.setValidationFailedForPatternMessage=function(e){this.validationFailedForPatternMessage_=e},t.prototype.setValidationFailedForRequiredMessage=function(e){this.validationFailedForRequiredMessage_=e},t.prototype.setValidationFailedForEmailTypeMessage=function(e){this.validationFailedForEmailTypeMessage_=e},t.prototype.setValidationFailedForIntegerTypeMessage=function(e){this.validationFailedForIntegerTypeMessage_=e},t.prototype.setValidationFailedForNegativeTypeMessage=function(e){this.validationFailedForNegativeTypeMessage_=e},t.prototype.setValidationFailedForNonNegativeTypeMessage=function(e){this.validationFailedForNonNegativeTypeMessage_=e},t.prototype.setValidationFailedForNumericTypeMessage=function(e){this.validationFailedForNumericTypeMessage_=e},t.prototype.setValidationFailedForPositiveTypeMessage=function(e){this.validationFailedForPositiveTypeMessage_=e},t}();e.FormForConfiguration=t,angular.module("formFor").service("FormForConfiguration",function(){return new t})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(e){this.formForConfiguration_=e}return t.prototype.manageLabel=function(t,r,i){r.hasOwnProperty("label")&&r.$observe("label",function(e){t.label=e}),this.formForConfiguration_.autoGenerateLabels&&(t.label=e.StringUtil.humanize(i?t.value:t.attribute))},t.prototype.manageFieldRegistration=function(e,t,r){e.$watch("attribute",function(i,o){e.model&&r.unregisterFormField(o),e.model=r.registerFormField(e.attribute),t.uid&&(e.model.uid=t.uid)}),e.$on("$destroy",function(){r.unregisterFormField(e.attribute)})},t}();e.FieldHelper=t,angular.module("formFor").service("FieldHelper",["FormForConfiguration",function(e){return new t(e)}])}(formFor||(formFor={}));var formFor;!function(e){function t(e,t){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/checkbox-field.html",scope:{attribute:"@",disable:"=",help:"@?",changed:"@?"},link:function(r,i,o,a){return r.attribute?(r.tabIndex=o.tabIndex||0,r.toggle=function(){r.disable||r.model.disabled||(r.model.bindable=!r.model.bindable)},t.manageLabel(r,o,!1),void t.manageFieldRegistration(r,o,a)):void e.error('Missing required field "attribute"')}}}e.CheckboxFieldDirective=t,angular.module("formFor").directive("checkboxField",["$log","FieldHelper",function(e,r){return t(e,r)}])}(formFor||(formFor={}));var formFor;!function(e){function t(e){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/collection-label.html",scope:{attribute:"@",help:"@?",label:"@"},link:function(t,r,i,o){t.$watch("label",function(r){t.bindableLabel=e.trustAsHtml(r)}),t.model=o.registerCollectionLabel(t.attribute)}}}e.CollectionLabelDirective=t,angular.module("formFor").directive("collectionLabel",["$sce",function(e){return t(e)}])}(formFor||(formFor={}));var formFor;!function(e){function t(){return{restrict:"EA",templateUrl:"form-for/templates/field-error.html",scope:{error:"=",leftAligned:"@?",uid:"@"},link:function(){}}}e.FieldErrorDirective=t,angular.module("formFor").directive("fieldError",t)}(formFor||(formFor={}));var formFor;!function(e){function t(e,t){return{replace:!0,restrict:"EA",templateUrl:"form-for/templates/field-label.html",scope:{inputUid:"@",help:"@?",label:"@",required:"@?",uid:"@"},controller:function(r){r.$watch("label",function(t){r.bindableLabel=e.trustAsHtml(t)}),r.$watch("required",function(e){r.requiredLabel=r.$eval(e)?t.requiredLabel:null})},link:function(e,t,r){e.attributes=r}}}e.FieldLabelDirective=t,angular.module("formFor").directive("fieldLabel",["$sce","FormForConfiguration",function(e,r){return t(e,r)}])}(formFor||(formFor={}));var formFor;!function(e){function t(t,r){var i=new e.NestedObjectHelper(r);return{require:"formFor",restrict:"A",link:function(r,o,a,n){var l;a.formForBuilder?l=r.$eval(a.formForBuilder):a.validationRules?l=r.$eval(a.validationRules):a.$service&&(l=r.$eval(a.$service.validationRules));for(var u=i.flattenObjectKeys(l),s="",d=0,f=u.length;f>d;d++){var c=u[d],m=i.readAttribute(l,c);if(m&&m.hasOwnProperty("inputType")){var p,F=m.help||"",b=m.label||"",v=m.uid||"",h=b?'label="'+b+'"':"";switch(m.inputType){case e.BuilderFieldType.CHECKBOX:s+='<checkbox-field attribute="'+c+'"\n                                               help="'+F+'"\n                                               '+h+'\n                                               uid="'+v+'">\n                               </checkbox-field>';break;case e.BuilderFieldType.RADIO:p=JSON.stringify(m.values).replace(/"/g,"&quot;"),s+='<radio-field attribute="'+c+'"\n                                            '+h+'\n                                            options="'+p+'"\n                                            uid="'+v+'">\n                               </radio-field>';break;case e.BuilderFieldType.SELECT:p=JSON.stringify(m.values).replace(/"/g,"&quot;"),s+='<select-field attribute="'+c+'"\n                                             '+(m.allowBlank?"allow-blank":"")+"\n                                             "+(m.enableFiltering?"enable-filtering":"")+'\n                                             help="'+F+'"\n                                             '+h+"\n                                             "+h+'\n                                             multiple="'+!!m.multipleSelection+'"\n                                             options="'+p+'"\n                                             uid="'+v+'"\n                                             value-attribute="'+(m.valueAttribute||"")+'">\n                               </select-field>';break;case e.BuilderFieldType.NUMBER:case e.BuilderFieldType.PASSWORD:case e.BuilderFieldType.TEXT:s+='<text-field attribute="'+c+'"\n                                           '+h+'\n                                           help="'+F+'"\n                                           ng-attr-multiline="'+!!m.multiline+'"\n                                           rows="'+(m.rows||"")+'"\n                                           type="'+m.inputType+'"\n                                           uid="'+v+'">\n                               </text-field>'}}}0===o.find("input[type=button], button").length&&(s+='<submit-button label="Submit"></submit-button>');var g=t(s),_=g(r,void 0,{transcludeControllers:n});o.prepend(_)}}}e.FormForBuilderDirective=t,angular.module("formFor").directive("formForBuilder",["$compile","$parse",function(e,r){return t(e,r)}])}(formFor||(formFor={}));var formFor;!function(e){function t(e,t,r,i){return{priority:99,require:"ngModel",restrict:"A",scope:{formForDebounce:"@"},link:function(o,a,n,l){if("radio"===n.type||"checkbox"===n.type)return void e.warn("formForDebounce should only be used with <input type=text> and <textarea> elements");var u=n.formForDebounce,s=i.defaultDebounceDuration;void 0!==u&&("false"===u.toString()?s=!1:(u=parseInt(u),angular.isNumber(u)&&!isNaN(u)&&(s=u))),t.hasEvent("input")?a.off("input"):(a.off("keydown"),t.hasEvent("paste")&&a.off("paste"));var d;if(s!==!1){var f=function(){r.cancel(d),d=r(function(){o.$apply(function(){l.$setViewValue(a.val())})},s)};t.hasEvent("input")?a.on("input",void 0,f):(a.on("keydown",void 0,f),t.hasEvent("paste")&&a.on("paste",void 0,f))}a.on("blur",void 0,function(){o.$apply(function(){l.$setViewValue(a.val())})}),o.$on("$destroy",function(){d&&r.cancel(d)})}}}e.FormForDebounceDirective=t,angular.module("formFor").directive("formForDebounce",["$log","$sniffer","$timeout","FormForConfiguration",function(e,r,i,o){return t(e,r,i,o)}])}(formFor||(formFor={}));var formFor;!function(e){function t(){return{require:"ngInclude",restrict:"A",link:function(e,t){t.replaceWith(t.children())}}}e.FormForIncludeReplaceDirective=t,angular.module("formFor").directive("formForIncludeReplace",function(){return t()})}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e){this.$parse_=e}return e.prototype.flattenAttribute=function(e){return e.replace(/\[([^\]]+)\]\.{0,1}/g,"___$1___").replace(/\./g,"___")},e.prototype.flattenObjectKeys=function(e){for(var t=[],r=[{object:e,prefix:null}];;){if(0===r.length)break;var i=r.pop(),o=Array.isArray(i.object),a=i.prefix?i.prefix+(o?"[":"."):"",n=o?"]":"";if("object"==typeof i.object)for(var l in i.object){var u=a+l+n,s=i.object[l];t.push(u),r.push({object:s,prefix:u})}}return t},e.prototype.readAttribute=function(e,t){return this.$parse_(t)(e)},e.prototype.writeAttribute=function(e,t,r){this.initializeArraysAndObjectsForParse_(e,t),this.$parse_(t).assign(e,r)},e.prototype.initializeArraysAndObjectsForParse_=function(e,t){for(var r=0;;){if(r=t.indexOf("[",r),0>r)break;var i=t.substr(0,r),o=this.readAttribute(e,i);o||(o=[],this.writeAttribute(e,i,o));var a=t.substr(r).match(/([0-9]+)\]\./);if(a){var n=parseInt(a[1]);o[n]||(o[n]={})}r++}},e}();e.NestedObjectHelper=t}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(e){this.$q_=e}return e.prototype.all=function(e){return this.$q_.all(e)},e.prototype.defer=function(){return this.$q_.defer()},e.prototype.resolve=function(e){var t=this.$q_.defer();return t.resolve(e),t.promise},e.prototype.reject=function(e){return this.$q_.reject(e)},e.prototype.waitForAll=function(e){function t(e,t){o.hasOwnProperty(e)||(o[e]=t,a--),r()}function r(){0===a&&(n?i.reject(o):i.resolve(o))}var i=this.$q_.defer(),o={},a=0,n=!1;return angular.forEach(e,function(e,r){a++,e.then(function(e){t(r,e)},function(e){n=!0,t(r,e)})}),r(),i.promise},e.prototype.when=function(e){return this.$q_.when(e)},e}();e.PromiseUtils=t}(formFor||(formFor={}));var formFor;!function(e){function t(t,r,i,o,a){var n=new e.NestedObjectHelper(r),l=new e.PromiseUtils(i);return t.registerCollectionLabel=function(e){var t=n.flattenAttribute(e),r={error:null,required:a.isCollectionRequired(e,o.$validationRuleset)};o.collectionLabels[t]=r;var i=!1;return o.$watch("formFor."+e+".length",function(){i?o.validateOn&&"change"!==o.validateOn||a.validateCollection(o.formFor,e,o.$validationRuleset).then(function(){o.formForStateHelper.setFieldError(t,null)},function(e){o.formForStateHelper.setFieldError(t,e)}):i=!0}),r},t.registerFormField=function(i){if(!i)throw Error('Invalid field name "'+i+'" provided.');var l=n.flattenAttribute(i);if(o.fields.hasOwnProperty(l))throw Error('Field "'+i+'" has already been registered. Field names must be unique.');var u={bindable:null,disabled:o.disable,error:null,pristine:!0,required:a.isFieldRequired(i,o.$validationRuleset),uid:e.FormForGUID.create()},s={bindableWrapper:u,fieldName:i,formForStateHelper:o.formForStateHelper,unwatchers:[]};o.fields[l]=s;var d=r(i),f=d.assign;s.unwatchers.push(o.$watch("fields."+l+".bindableWrapper.bindable",function(e,t){e!==t&&f(o.formFor,e)}));var c;return s.unwatchers.push(o.$watch("formFor."+i,function(e,r){(e!==s.bindableWrapper.bindable||void 0===r&&""===e||void 0===e)&&(c=!1),s.bindableWrapper.bindable=e,o.validateOn&&"change"!==o.validateOn||t.validateField(i),c||(c=!0,o.formForStateHelper.setFieldHasBeenModified(l,!1)),s.bindableWrapper.pristine=!o.formForStateHelper.hasFieldBeenModified(l)})),u},t.registerSubmitButton=function(){var e={disabled:!1};return o.buttons.push(e),e},t.resetErrors=function(){for(var e in o.fields)o.formForStateHelper.getFieldError(e)&&(o.formForStateHelper.setFieldHasBeenModified(e,!1),o.fields[e].bindableWrapper.pristine=!0);o.formForStateHelper.setFormSubmitted(!1),o.formForStateHelper.resetFieldErrors()},t.resetField=function(e){var t=n.flattenAttribute(e);o.formForStateHelper.getFieldError(t)&&(o.formForStateHelper.setFieldHasBeenModified(t,!1),o.fields[t].bindableWrapper.pristine=!0),o.formForStateHelper.setFieldError(t,null)},t.resetFields=function(){t.resetErrors()},t.setFieldError=function(e,t){var r=n.flattenAttribute(e);o.formForStateHelper.setFieldHasBeenModified(r,!0),o.formForStateHelper.setFieldError(r,t)},t.unregisterFormField=function(e){var t=n.flattenAttribute(e);angular.forEach(o.fields[t].unwatchers,function(e){e()}),delete o.fields[t]},t.updateCollectionErrors=function(e){angular.forEach(o.collectionLabels,function(t,r){var i=n.readAttribute(e,r);o.formForStateHelper.setFieldError(r,i)})},t.updateFieldErrors=function(e){angular.forEach(o.fields,function(t,r){var i=n.readAttribute(e,t.fieldName);o.formForStateHelper.setFieldError(r,i)})},t.validateField=function(e){var t=n.flattenAttribute(e);o.formForStateHelper.setFieldHasBeenModified(t,!0),o.$validationRuleset&&a.validateField(o.formFor,e,o.$validationRuleset).then(function(){o.formForStateHelper.setFieldError(t,null)},function(e){o.formForStateHelper.setFieldError(t,e)})},t.validateForm=function(e){t.updateCollectionErrors({}),t.updateFieldErrors({});var r,i;if(o.$validationRuleset){var u=[];angular.forEach(o.fields,function(e){u.push(e.fieldName)}),i=a.validateFields(o.formFor,u,o.$validationRuleset),i.then(angular.noop,t.updateFieldErrors),u=[],angular.forEach(o.collectionLabels,function(e,t){u.push(t)}),r=a.validateFields(o.formFor,u,o.$validationRuleset),r.then(angular.noop,t.updateCollectionErrors)}else r=l.resolve(),i=l.resolve();var s=l.defer();return l.waitForAll([r,i]).then(s.resolve,function(t){angular.isArray(t[0])&&0===t[0].length&&t.splice(0,1),e&&angular.forEach(t,function(e){var t=n.flattenObjectKeys(e);angular.forEach(t,function(t){var r=n.readAttribute(e,t);if(r){var i=n.flattenAttribute(t);o.formForStateHelper.setFieldHasBeenModified(i,!0)}})}),s.reject(t)}),s.promise},t}e.createFormForController=t}(formFor||(formFor={}));var formFor;!function(e){function t(t){var r=t.get("$log"),i=t.get("$parse"),o=t.get("$q"),a=t.get("$sce"),n=t.get("FormForConfiguration"),l=t.get("ModelValidator"),u=new e.PromiseUtils(o);return{require:"form",restrict:"A",scope:{controller:"=?",disable:"=?",formFor:"=",service:"@",submitComplete:"&?",submitError:"&?",submitWith:"&?",valid:"=?",validateOn:"=?",validationFailed:"&?",validationRules:"=?"},controller:function(o){o.formFor||r.error('The form data object specified by <form form-for=""> is null or undefined.'),o.fields={},o.collectionLabels={},o.buttons=[],o.controller=o.controller||{},o.service&&(o.$service=t.get(o.service)),o.validationRules?o.$validationRuleset=o.validationRules:o.$service&&(o.$validationRuleset=o.$service.validationRules),e.createFormForController(this,i,u,o,l),o.controller&&angular.copy(this,o.controller),o.$watch("disable",function(e){angular.forEach(o.fields,function(t){t.bindableWrapper.disabled=e}),angular.forEach(o.buttons,function(t){t.disabled=e})}),o.formForStateHelper=new e.FormForStateHelper(i,o),o.$watch("formForStateHelper.watchable",function(){var e=o.formForStateHelper.hasFormBeenSubmitted();angular.forEach(o.fields,function(t,r){if(e||o.formForStateHelper.hasFieldBeenModified(r)){var i=o.formForStateHelper.getFieldError(r);t.bindableWrapper.error=i?a.trustAsHtml(i):null}else t.bindableWrapper.error=null}),angular.forEach(o.collectionLabels,function(e,t){var r=o.formForStateHelper.getFieldError(t);e.error=r?a.trustAsHtml(r):null})})},link:function(e,t,r){t.on("submit",void 0,function(){e.formForStateHelper.setFormSubmitted(!0),e.disable=!0;var t;return t="manual"===e.validateOn?u.resolve():e.controller.validateForm(),t.then(function(){var t;t=r.submitWith?e.submitWith({data:e.formFor}):e.$service&&e.$service.submit?e.$service.submit(e.formFor):u.reject("No submit function provided"),t||(t=u.reject("Submit function did not return a promise")),t.then(function(t){r.submitComplete?e.submitComplete({data:t}):n.defaultSubmitComplete(t)},function(t){angular.isObject(t)&&"manual"!==e.validateOn&&(e.controller.updateCollectionErrors(t),e.controller.updateFieldErrors(t)),r.submitError?e.submitError({error:t}):n.defaultSubmitError(t)}),t["finally"](function(){e.disable=!1})},function(t){e.disable=!1,r.validationFailed?e.validationFailed():n.defaultValidationFailed(t)}),!1})}}}e.FormForDirective=t,angular.module("formFor").directive("formFor",["$injector",function(e){return t(e)}])}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(){}return e.create=function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)},e}();e.FormForGUID=t}(formFor||(formFor={}));var formFor;!function(e){function t(t,r){var i=new e.FieldHelper(r);return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/radio-field.html",scope:{attribute:"@",disable:"=",help:"@?",options:"=",value:"@"},link:function(r,o,a,n){return r.attribute?(r.labelAttribute=a.labelAttribute||"label",r.valueAttribute=a.valueAttribute||"value",i.manageFieldRegistration(r,a,n),r.uid=a.uid||e.FormForGUID.create(),i.manageLabel(r,a,!0),r.tabIndex=a.tabIndex||0,r.click=function(){!r.disable&&!r.model.disabled},r.$watch("model",function(e){r.model=e}),r.$watch("disable",function(e){r.disable=e}),void r.$watch("model.disabled",function(e){r.model&&(r.model.disabled=e)})):void t.error('Missing required field "attribute"')}}}e.RadioFieldDirective=t,angular.module("formFor").directive("radioField",["$log","FormForConfiguration",function(e,r){return t(e,r)}])}(formFor||(formFor={}));var formFor;!function(e){function t(e,t,i,o){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/select-field.html",scope:{attribute:"@",disable:"=",filterDebounce:"@?",help:"@?",multiple:"=?",options:"="},link:function(a,n,l,u){if(!a.attribute)return void t.error('Missing required field "attribute"');a.allowBlank=l.hasOwnProperty("allowBlank"),a.enableFiltering=l.hasOwnProperty("enableFiltering"),a.preventDefaultOption=l.hasOwnProperty("preventDefaultOption"),a.labelAttribute=l.labelAttribute||"label",a.valueAttribute=l.valueAttribute||"value",a.placeholder=l.hasOwnProperty("placeholder")?l.placeholder:"Select",a.tabIndex=l.tabIndex||0,a.scopeBuster={},o.manageLabel(a,l,!1),o.manageFieldRegistration(a,l,u);var s,d=function(){s||(s=n.find("input")),i(s.focus.bind(s))};a.close=function(){i(function(){a.isOpen=!1})},a.open=function(){a.disable||a.model.disabled||i(function(){a.isOpen=!0})},a.emptyOption={},a.emptyOption[a.labelAttribute]="",a.emptyOption[a.valueAttribute]=void 0,a.placeholderOption={},a.placeholderOption[a.labelAttribute]=a.placeholder,a.placeholderOption[a.valueAttribute]=void 0,a.filteredOptions=[];var f=function(e){return e&&e.toLowerCase()},c=function(){var e=a.options||[];if(a.filteredOptions.splice(0),a.enableFiltering&&a.scopeBuster.filter){var t=f(a.scopeBuster.filter);angular.forEach(e,function(e){var r=f(e[a.labelAttribute]).indexOf(t);r>=0&&a.filteredOptions.push(e)})}else angular.copy(e,a.filteredOptions);a.selectedOption||a.multiple||a.enableFiltering?a.allowBlank&&a.filteredOptions.unshift(a.emptyOption):a.filteredOptions.unshift(a.placeholderOption)};a.$watch("scopeBuster.filter",c),a.$watch("options.length",c);var m=function(){var e=a.selectedOption&&a.selectedOption[a.valueAttribute],t=a.options&&a.options.length;e!==a.model.bindable||a.allowBlank||a.preventDefaultOption||!t||(a.model.bindable=a.options[0][a.valueAttribute])};a.$watch("model.bindable",m),a.$watch("options.length",m),a.$watch("model.bindable",function(){var e=null;angular.forEach(a.options,function(t){t[a.valueAttribute]===a.model.bindable&&(e=t)}),e&&(a.selectedOption=e,a.selectedOptionLabel=e[a.labelAttribute]),a.scopeBuster.filter=a.selectedOptionLabel});var p=function(e){e.ignoreFor!==a.model.uid&&a.close()};a.filterTextClick=function(e){a.isOpen&&(e.ignoreFor=a.model.uid)};var F;a.$watch("isOpen",function(){F&&i.cancel(F),F=i(function(){F=null,a.isOpen?e.on("click",void 0,p):e.off("click",void 0,p)},r)}),a.$on("$destroy",function(){e.off("click",p)}),a.setFilterFocus=function(){d()},a.mouseOver=function(e){a.mouseOverIndex=e,a.mouseOverOption=e>=0?a.filteredOptions[e]:null},a.selectOption=function(e){a.model.bindable=e&&e[a.valueAttribute]},a.keyDown=function(e){switch(e.keyCode){case 27:a.close();break;case 13:a.isOpen?(a.selectOption(a.mouseOverOption),a.close()):a.open(),e.preventDefault();break;case 38:a.isOpen?a.mouseOver(a.mouseOverIndex>0?a.mouseOverIndex-1:a.filteredOptions.length-1):a.open();break;case 40:a.isOpen?a.mouseOver(a.mouseOverIndex<a.filteredOptions.length-1?a.mouseOverIndex+1:0):a.open();break;case 9:case 16:a.close();break;default:a.open()}},a.$watchCollection("[isOpen, filteredOptions.length]",function(){a.mouseOver(-1),a.isOpen&&a.enableFiltering&&d()})}}}var r=10;e.SelectFieldDirective=t,angular.module("formFor").directive("selectField",["$document","$log","$timeout","FieldHelper",function(e,r,i,o){return t(e,r,i,o)}])}(formFor||(formFor={}));var formFor;!function(e){function t(e){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/submit-button.html",scope:{disable:"=",icon:"@",label:"@"},link:function(t,r,i,o){t.buttonClass=i.buttonClass,t.tabIndex=i.tabIndex||0,t.$watch("label",function(r){t.bindableLabel=e.trustAsHtml(r)}),t.model=o.registerSubmitButton(t)}}}e.SubmitButtonDirective=t,angular.module("formFor").directive("submitButton",["$sce",function(e){return t(e)}])}(formFor||(formFor={}));var formFor;!function(e){function t(e,t,r){return{require:"^formFor",restrict:"EA",templateUrl:"form-for/templates/text-field.html",scope:{attribute:"@",debounce:"@?",disable:"=",focused:"&?",blurred:"&?",help:"@?",iconAfterClicked:"&?",iconBeforeClicked:"&?",placeholder:"@?",rows:"=?"},link:function(i,o,a,n){if(!i.attribute)return void e.error('Missing required field "attribute"');if(i.attributes=a,i.rows=i.rows||3,i.type=a.type||"text",i.multiline=a.hasOwnProperty("multiline")&&"false"!==a.multiline,i.tabIndex=a.tabIndex||0,a.hasOwnProperty("autofocus")&&t(function(){o.find(i.multiline?"textarea":"input")[0].focus()}),r.manageLabel(i,a,!1),r.manageFieldRegistration(i,a,n),a.iconAfter){var l=function(){if(i.model){var e="{"===a.iconAfter.charAt(0)?i.$eval(a.iconAfter):a.iconAfter;i.iconAfter=angular.isObject(e)?i.model.error?e.invalid:i.model.pristine?e.pristine:e.valid:e}};a.$observe("iconAfter",l),i.$watch("model.error",l),i.$watch("model.pristine",l)}if(a.iconBefore){var u=function(){if(i.model){var e="{"===a.iconBefore.charAt(0)?i.$eval(a.iconBefore):a.iconBefore;i.iconBefore=angular.isObject(e)?i.model.error?e.invalid:i.model.pristine?e.pristine:e.valid:e}};a.$observe("iconBefore",u),i.$watch("model.error",u),i.$watch("model.pristine",u)}i.onIconAfterClick=function(){a.hasOwnProperty("iconAfterClicked")&&i.iconAfterClicked()},i.onIconBeforeClick=function(){a.hasOwnProperty("iconBeforeClicked")&&i.iconBeforeClicked()},i.onFocus=function(){a.hasOwnProperty("focused")&&i.focused()},i.onBlur=function(){a.hasOwnProperty("blurred")&&i.blurred()}}}}e.TextFieldDirective=t,angular.module("formFor").directive("textField",["$log","$timeout","FieldHelper",function(e,r,i){return t(e,r,i)}])}(formFor||(formFor={}));var formFor;!function(e){!function(e){e[e.CHECKBOX="checkbox"]="CHECKBOX",e[e.NUMBER="number"]="NUMBER",e[e.PASSWORD="password"]="PASSWORD",e[e.RADIO="radio"]="RADIO",e[e.SELECT="select"]="SELECT",e[e.TEXT="text"]="TEXT"}(e.BuilderFieldType||(e.BuilderFieldType={}));e.BuilderFieldType}(formFor||(formFor={}));var formFor;!function(e){!function(e){e[e.COLLECTION_MAX_SIZE="COLLECTION_MAX_SIZE"]="COLLECTION_MAX_SIZE",e[e.COLLECTION_MIN_SIZE="COLLECTION_MIN_SIZE"]="COLLECTION_MIN_SIZE",e[e.CUSTOM="CUSTOM"]="CUSTOM",e[e.MAXIMUM="MAXIMUM"]="MAXIMUM",e[e.MAX_LENGTH="MAX_LENGTH"]="MAX_LENGTH",e[e.MINIMUM="MINIMUM"]="MINIMUM",e[e.MIN_LENGTH="MIN_LENGTH"]="MIN_LENGTH",e[e.PATTERN="PATTERN"]="PATTERN",e[e.REQUIRED="REQUIRED_FIELD"]="REQUIRED",e[e.TYPE_EMAIL="TYPE_EMAIL"]="TYPE_EMAIL",e[e.TYPE_INTEGER="TYPE_INTEGER"]="TYPE_INTEGER",e[e.TYPE_NEGATIVE="TYPE_NEGATIVE"]="TYPE_NEGATIVE",e[e.TYPE_NON_NEGATIVE="TYPE_NON_NEGATIVE"]="TYPE_NON_NEGATIVE",e[e.TYPE_NUMERIC="TYPE_NUMERIC"]="TYPE_NUMERIC",e[e.TYPE_POSITIVE="TYPE_POSITIVE"]="TYPE_POSITIVE"}(e.ValidationFailureType||(e.ValidationFailureType={}));e.ValidationFailureType}(formFor||(formFor={}));var formFor;!function(e){!function(e){e[e.EMAIL="email"]="EMAIL",e[e.INTEGER="integer"]="INTEGER",e[e.NEGATIVE="negative"]="NEGATIVE",e[e.NON_NEGATIVE="nonNegative"]="NON_NEGATIVE",e[e.NUMBER="number"]="NUMBER",e[e.POSITIVE="positive"]="POSITIVE"}(e.ValidationFieldType||(e.ValidationFieldType={}));e.ValidationFieldType}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(){}return e}();e.BindableFieldWrapper=t}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t,r,i,o){this.$interpolate_=t,this.formForConfiguration_=o,this.nestedObjectHelper_=new e.NestedObjectHelper(r),this.promiseUtils_=new e.PromiseUtils(i)}return t.prototype.isCollectionRequired=function(e,t){var r=this.getRulesFor_(e,t);return r&&r.collection&&r.collection.min?angular.isObject(r.collection.min)?r.collection.min.rule>0:r.collection.min>0:!1},t.prototype.isFieldRequired=function(e,t){var r=this.getRulesFor_(e,t);return r&&r.required?angular.isObject(r.required)?r.required.rule:!!r.required:!1},t.prototype.validateAll=function(e,t){var r=this.nestedObjectHelper_.flattenObjectKeys(e);return this.validateFields(e,r,t)},t.prototype.validateCollection=function(e,t,r){var i=this.getRulesFor_(t,r),o=this.nestedObjectHelper_.readAttribute(e,t);return i&&i.collection?(o=o||[],this.validateCollectionMinLength_(o,i.collection)||this.validateCollectionMaxLength_(o,i.collection)||this.promiseUtils_.resolve()):this.promiseUtils_.resolve()},t.prototype.validateField=function(e,t,r){var i=this.getRulesFor_(t,r),o=this.nestedObjectHelper_.readAttribute(e,t);return i?((void 0===o||null===o)&&(o=""),this.validateFieldRequired_(o,i)||this.validateFieldMinimum_(o,i)||this.validateFieldMinLength_(o,i)||this.validateFieldMaximum_(o,i)||this.validateFieldMaxLength_(o,i)||this.validateFieldType_(o,i)||this.validateFieldPattern_(o,i)||this.validateFieldCustom_(o,e,i)||this.promiseUtils_.resolve()):this.promiseUtils_.resolve()},t.prototype.validateFields=function(e,t,r){var i=this,o=this.promiseUtils_.defer(),a=[],n={};return angular.forEach(t,function(t){var o=i.getRulesFor_(t,r);if(o){var l;l=o.collection?i.validateCollection(e,t,r):i.validateField(e,t,r),l.then(angular.noop,function(e){i.nestedObjectHelper_.writeAttribute(n,t,e)}),a.push(l)}},this),this.promiseUtils_.waitForAll(a).then(o.resolve,function(){o.reject(n)}),o.promise},t.prototype.getRulesFor_=function(e,t){var r=e.replace(/\[[^\]]+\]/g,".collection.fields");return this.nestedObjectHelper_.readAttribute(t,r)},t.prototype.getFieldTypeFailureMessage_=function(e,t){return angular.isObject(e.type)?e.type.message:this.formForConfiguration_.getFailedValidationMessage(t);

},t.isConsideredNumeric_=function(e,t){return e&&!isNaN(t)},t.prototype.validateCollectionMinLength_=function(t,r){if(r.min){var i=angular.isObject(r.min)?r.min.rule:r.min;if(t.length<i){var o;return o=angular.isObject(r.min)?r.min.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.COLLECTION_MIN_SIZE))({num:i}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateCollectionMaxLength_=function(t,r){if(r.max){var i=angular.isObject(r.max)?r.max.rule:r.max;if(t.length>i){var o;return o=angular.isObject(r.max)?r.max.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.COLLECTION_MAX_SIZE))({num:i}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateFieldCustom_=function(t,r,i){var o=this;if(i.custom){var a,n;angular.isFunction(i.custom)?(a=this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.CUSTOM),n=i.custom):(a=i.custom.message,n=i.custom.rule);try{var l=n(t,r)}catch(u){return this.promiseUtils_.reject(u.message||a)}return angular.isObject(l)&&angular.isFunction(l.then)?l.then(function(e){return o.promiseUtils_.resolve(e)},function(e){return o.promiseUtils_.reject(e||a)}):l?this.promiseUtils_.resolve(l):this.promiseUtils_.reject(a)}return null},t.prototype.validateFieldMaximum_=function(t,r){if(r.maximum){var i=t.toString(),o=Number(t),a=angular.isObject(r.maximum)?r.maximum.rule:r.maximum;if(i&&!isNaN(o)&&o>a){var n;return n=angular.isObject(r.maximum)?r.maximum.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.MAXIMUM))({num:a}),this.promiseUtils_.reject(n)}}return null},t.prototype.validateFieldMaxLength_=function(t,r){if(r.maxlength){var i=angular.isObject(r.maxlength)?r.maxlength.rule:r.maxlength;if(t.length>i){var o;return o=angular.isObject(r.maxlength)?r.maxlength.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.MAX_LENGTH))({num:i}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateFieldMinimum_=function(t,r){if(r.minimum){var i=t.toString(),o=Number(t),a=angular.isObject(r.minimum)?r.minimum.rule:r.minimum;if(i&&!isNaN(o)&&a>o){var n;return n=angular.isObject(r.minimum)?r.minimum.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.MINIMUM))({num:a}),this.promiseUtils_.reject(n)}}return null},t.prototype.validateFieldMinLength_=function(t,r){if(r.minlength){var i=angular.isObject(r.minlength)?r.minlength.rule:r.minlength;if(t&&t.length<i){var o;return o=angular.isObject(r.minlength)?r.minlength.message:this.$interpolate_(this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.MIN_LENGTH))({num:i}),this.promiseUtils_.reject(o)}}return null},t.prototype.validateFieldRequired_=function(t,r){if(r.required){var i=angular.isObject(r.required)?r.required.rule:r.required,o=t.toString().replace(/\s+$/,""),a=Number(t);if(i&&!o&&!a){var n;return n=angular.isObject(r.required)?r.required.message:this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.REQUIRED),this.promiseUtils_.reject(n)}}return null},t.prototype.validateFieldPattern_=function(t,r){if(r.pattern){var i=r.pattern instanceof RegExp,o=i?r.pattern:r.pattern.rule;if(!o.exec(t)){var a=i?this.formForConfiguration_.getFailedValidationMessage(e.ValidationFailureType.PATTERN):r.pattern.message;return this.promiseUtils_.reject(a)}}return null},t.prototype.validateFieldType_=function(r,i){if(i.type){var o=angular.isObject(i.type)?i.type.rule:i.type,a=r.toString(),n=Number(r);if(o)for(var l=o.split(" "),u=0,s=l.length;s>u;u++){var d=l[u];switch(d){case e.ValidationFieldType.INTEGER:if(a&&(isNaN(n)||n%1!==0))return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(i,e.ValidationFailureType.TYPE_INTEGER));break;case e.ValidationFieldType.NUMBER:if(a&&isNaN(n))return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(i,e.ValidationFailureType.TYPE_NUMERIC));break;case e.ValidationFieldType.NEGATIVE:if(t.isConsideredNumeric_(a,n)&&n>=0)return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(i,e.ValidationFailureType.TYPE_NEGATIVE));break;case e.ValidationFieldType.NON_NEGATIVE:if(t.isConsideredNumeric_(a,n)&&0>n)return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(i,e.ValidationFailureType.TYPE_NON_NEGATIVE));break;case e.ValidationFieldType.POSITIVE:if(t.isConsideredNumeric_(a,n)&&0>=n)return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(i,e.ValidationFailureType.TYPE_POSITIVE));break;case e.ValidationFieldType.EMAIL:if(a&&!a.match(/^.+@.+\..+$/))return this.promiseUtils_.reject(this.getFieldTypeFailureMessage_(i,e.ValidationFailureType.TYPE_EMAIL))}}}return null},t}();e.ModelValidator=t,angular.module("formFor").service("ModelValidator",["$interpolate","$parse","$q","FormForConfiguration",function(e,r,i,o){return new t(e,r,i,o)}])}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function t(t,r){this.formForScope_=r,this.nestedObjectHelper_=new e.NestedObjectHelper(t),this.formForScope_.fieldNameToErrorMap=r.fieldNameToErrorMap||{},this.formForScope_.valid=!0,this.fieldNameToModifiedStateMap_={},this.formSubmitted_=!1,this.fieldNameToErrorMap_={},this.watchable=0}return t.prototype.getFieldError=function(e){return this.nestedObjectHelper_.readAttribute(this.formForScope_.fieldNameToErrorMap,e)},t.prototype.hasFieldBeenModified=function(e){return this.nestedObjectHelper_.readAttribute(this.fieldNameToModifiedStateMap_,e)},t.prototype.hasFormBeenSubmitted=function(){return this.formSubmitted_},t.prototype.isFormInvalid=function(){return!this.isFormValid()},t.prototype.isFormValid=function(){for(var e in this.fieldNameToErrorMap_)return!1;return!0},t.prototype.resetFieldErrors=function(){this.formForScope_.fieldNameToErrorMap={}},t.prototype.setFieldError=function(e,t){var r=this.nestedObjectHelper_.flattenAttribute(e);this.nestedObjectHelper_.writeAttribute(this.formForScope_.fieldNameToErrorMap,e,t),t?this.fieldNameToErrorMap_[r]=t:delete this.fieldNameToErrorMap_[r],this.formForScope_.valid=this.isFormValid(),this.watchable++},t.prototype.setFieldHasBeenModified=function(e,t){this.nestedObjectHelper_.writeAttribute(this.fieldNameToModifiedStateMap_,e,t),this.watchable++},t.prototype.setFormSubmitted=function(e){this.formSubmitted_=e,this.watchable++},t}();e.FormForStateHelper=t}(formFor||(formFor={}));var formFor;!function(e){var t=function(){function e(){}return e.humanize=function(e){return e?(e=e.replace(/[A-Z]/g,function(e){return" "+e}),e=e.replace(/_([a-z])/g,function(e,t){return" "+t.toUpperCase()}),e=e.replace(/\s+/g," "),e=e.trim(),e=e.charAt(0).toUpperCase()+e.slice(1)):""},e}();e.StringUtil=t}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));var formFor;!function(){}(formFor||(formFor={}));
//# sourceMappingURL=form-for.min.js.map